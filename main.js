(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var n=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._nameUser=document.querySelector(e),this._aboutUser=document.querySelector(n),this._avatarUser=document.querySelector(r)}var n,r;return n=t,(r=[{key:"getUserInfo",value:function(){return{name:this._nameUser.textContent,about:this._aboutUser.textContent}}},{key:"setUserInfo",value:function(t){var e=t.name,n=t.about;this._nameUser.textContent=e,this._aboutUser.textContent=n}},{key:"setAvatar",value:function(t){this._avatarUser.src=t}},{key:"setUserId",value:function(t){this._userId=t}},{key:"getUserId",value:function(){return this._userId}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function i(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===r(e)?e:String(e)}var a=function(){function t(e,n){var r=this,o=e.data,u=e.userId,a=e.handleCardClick,c=e.handleTrashClick,l=e.handleLikeClick;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"_addLike",(function(){r._elementLike.classList.add("elements__like_active"),r._isLiked=!0,r._elementLikeCounter.textContent=r._likeCounter})),i(this,"_removeLike",(function(){r._elementLike.classList.remove("elements__like_active"),r._isLiked=!1,r._elementLikeCounter.textContent=r._likeCounter})),i(this,"_setLikesCounter",(function(t){r._likeCounter=t.likes.length})),i(this,"_removeCard",(function(){r._element.remove(),r._element=null})),i(this,"_handleCardImageClick",(function(){r._handleCardClick({name:r._name,link:r._link})})),i(this,"_handleTrashImageClick",(function(){r._handleTrashClick(r._cardId,r._removeCard)})),i(this,"_handleLikeImageClick",(function(){r._handleLikeClick(r._cardId,r._isLiked,r._addLike,r._removeLike,r._setLikesCounter)})),this._name=o.name,this._link=o.link,this._cardId=o._id,this._userId=u,this._ownerId=o.owner._id,this._isLiked=o.likes.some((function(t){return t._id===r._userId})),this._likeCounter=o.likes.length,this._templateSelector=n,this._handleCardClick=a,this._handleTrashClick=c,this._handleLikeClick=l,this._element=this._getTemplate(),this._elementTitle=this._element.querySelector(".elements__title"),this._elementPhoto=this._element.querySelector(".elements__photo"),this._elementLikeCounter=this._element.querySelector(".elements__like-counter"),this._elementTrash=this._element.querySelector(".elements__trash"),this._elementLike=this._element.querySelector(".elements__like")}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".elements__item").cloneNode(!0)}},{key:"_hasHiddenTrashBtn",value:function(){this._userId!==this._ownerId&&this._elementTrash.remove()}},{key:"_setEventListeners",value:function(){this._elementPhoto.addEventListener("click",this._handleCardImageClick),this._elementTrash.addEventListener("click",this._handleTrashImageClick),this._elementLike.addEventListener("click",this._handleLikeImageClick)}},{key:"generateCard",value:function(){return this._elementTitle.textContent=this._name,this._elementPhoto.alt=this._name,this._elementPhoto.src=this._link,this._elementLikeCounter.textContent=this._likeCounter,this._hasHiddenTrashBtn(),this._isLiked&&this._addLike(),this._setEventListeners(),this._element}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderer=e,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"addItem",value:function(t){this._container.prepend(t)}},{key:"renderItems",value:function(t){var e=this;t.reverse().forEach((function(t){e.addItem(e._renderer(t))}))}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function h(t,e,n){return(e=y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===f(e)?e:String(e)}var m=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),h(this,"_handleEscClose",(function(t){"Escape"===t.key&&n.close()})),h(this,"_handleOverlayClick",(function(t){t.target!==n._popup&&t.target!==n._closeButton||n.close()})),this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close")}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleOverlayClick)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleOverlayClick)}},{key:"setEventListeners",value:function(){var t=this;this._closeButton.addEventListener("click",(function(){t.close()}))}}])&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===v(o)?o:String(o)),r)}var o}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},d.apply(this,arguments)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(r);if(o){var n=k(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._popupImage=e._popup.querySelector(".popup__photo"),e._popupCaption=e._popup.querySelector(".popup__photo-caption"),e}return e=u,(n=[{key:"open",value:function(t){var e=t.name,n=t.link;this._popupImage.src=n,this._popupImage.alt=e,this._popupCaption.textContent=e,d(k(u.prototype),"open",this).call(this)}}])&&_(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},E.apply(this,arguments)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(r);if(o){var n=O(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._submitFormCallback=e,n._popupForm=n._popup.querySelector(".popup__form"),n._inputList=n._popup.querySelectorAll(".popup__input"),n._buttonForm=n._popup.querySelector(".popup__button-save"),n._buttonFormText=n._buttonForm.textContent,n}return e=u,(n=[{key:"_getInputValues",value:function(){var t={};return this._inputList.forEach((function(e){t[e.name]=e.value})),t}},{key:"setInputValues",value:function(t){this._inputList.forEach((function(e){e.value=t[e.name]}))}},{key:"setEventListeners",value:function(){var t=this;E(O(u.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",(function(e){e.preventDefault(),t._submitFormCallback(t._getInputValues()),t.close()}))}},{key:"setSaveButtonText",value:function(t){this._buttonForm.textContent=t?"Сохранение...":this._buttonFormText}},{key:"close",value:function(){E(O(u.prototype),"close",this).call(this),this._popupForm.reset()}}])&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==L(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===L(o)?o:String(o)),r)}var o}function I(){return I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},I.apply(this,arguments)}function T(t,e){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},T(t,e)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(r);if(o){var n=x(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._submitFormCallback=e,n._popupForm=n._popup.querySelector(".popup__form"),n._buttonForm=n._popup.querySelector(".popup__button-save"),n._buttonFormText=n._buttonForm.textContent,n}return e=u,(n=[{key:"submitCallback",value:function(t){this._submitFormCallback=t}},{key:"setEventListeners",value:function(){var t=this;I(x(u.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("click",(function(e){e.preventDefault(),t._submitFormCallback()}))}},{key:"setSaveButtonText",value:function(t){this._buttonForm.textContent=t?"Удаление...":this._buttonFormText}},{key:"open",value:function(t,e){I(x(u.prototype),"open",this).call(this),this._cardId=t,this._card=e}}])&&P(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==U(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===U(o)?o:String(o)),r)}var o}var q=function(){function t(e){var n=e.baseUrl,r=e.headers;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._headers=r}var e,n;return e=t,(n=[{key:"_checkResponse",value:function(t){if(t.ok)return t.json();Promise.reject("Ошибка: ".concat(t.status))}},{key:"getItems",value:function(){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return t._checkResponse(e)}))}},{key:"setItem",value:function(t){var e=this,n=t.name,r=t.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:n,link:r})}).then((function(t){return e._checkResponse(t)}))}},{key:"deleteItem",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"addLike",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"deleteLike",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"editAvatar",value:function(t){var e=this;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((function(t){return e._checkResponse(t)}))}},{key:"getUserInfo",value:function(){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return t._checkResponse(e)}))}},{key:"setUserInfo",value:function(t){var e=this,n=t.name,r=t.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:n,about:r})}).then((function(t){return e._checkResponse(t)}))}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==F(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===F(o)?o:String(o)),r)}var o}var D=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=n.querySelector(this._submitButtonSelector),this._formInputsHandler=this._formInputsHandler.bind(this)}var e,n;return e=t,(n=[{key:"_showInputError",value:function(t){var e=this._formElement.querySelector(".".concat(t.id,"-error"));t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(t){var e=this._formElement.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_formInputsHandler",value:function(t){t.target.matches(this._inputSelector)&&(this._checkInputValidity(t.target),this._toggleButtonState())}},{key:"_toggleButtonState",value:function(){var t=this._inputList.some((function(t){return!t.validity.valid}));this._buttonElement.disabled=t,this._buttonElement.classList.toggle(this._inactiveButtonClass,t)}},{key:"_resetFormHandler",value:function(){var t=this;this._inputList.forEach((function(e){t._hideInputError(e)})),this._toggleButtonState()}},{key:"_setEventListeners",value:function(){this._formElement.addEventListener("submit",(function(t){t.preventDefault()})),this._formElement.addEventListener("input",this._formInputsHandler),this._formElement.addEventListener("reset",this._resetFormHandler.bind(this)),this._toggleButtonState()}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"resetErrors",value:function(){this._resetFormHandler()}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),H=document.querySelector(".profile__avatar-block"),V=document.querySelector(".profile__button-edit"),N=document.querySelector(".profile__button-add-item");function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var M=new q({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-63/",headers:{authorization:"53225a79-808c-4502-af98-76089dda326c","Content-Type":"application/json"}}),z=new S(".popup_item_photo-view");z.setEventListeners();var $=new n(".profile__name",".profile__about",".profile__avatar"),G=function(t){return console.log("Ошибка: ".concat(t))};Promise.all([M.getUserInfo(),M.getItems()]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],u=o.name,a=o.about,c=o.avatar,l=o._id;$.setUserInfo({name:u,about:a}),$.setAvatar(c),$.setUserId(l),Q.renderItems(i)})).catch(G);var K=function(t){var e=$.getUserId(),n=new a({data:t,userId:e,handleCardClick:function(t,e){z.open(t,e)},handleTrashClick:function(t,e){Y.open(),Y.submitCallback((function(){Y.setSaveButtonText(!0),M.deleteItem(t).then((function(){e(),Y.close()})).catch(G).finally((function(){Y.setSaveButtonText(!1)}))}))},handleLikeClick:function(t,e,n,r,o){e?M.deleteLike(t).then((function(t){o(t),r()})).catch(G):M.addLike(t).then((function(t){o(t),n()})).catch(G)}},"#card-template").generateCard();return n},Q=new s(K,".elements__cards"),W=new j(".popup_edit",(function(t){W.setSaveButtonText(!0),M.setUserInfo(t).then((function(t){$.setUserInfo({name:t.name,about:t.about}),W.close()})).catch(G).finally((function(){W.setSaveButtonText(!1)}))}));W.setEventListeners();var X=new j(".popup_item",(function(t){X.setSaveButtonText(!0),M.setItem({name:t.title,link:t.url}).then((function(t){Q.addItem(K(t)),X.close()})).catch(G).finally((function(){X.setSaveButtonText(!1)}))}));X.setEventListeners();var Y=new R(".popup_item_delete-card");Y.setEventListeners();var Z=new j(".popup_edit-avatar",(function(t){var e=t.data;Z.setSaveButtonText(!0),M.editAvatar(e).then((function(t){$.setAvatar(t.avatar),Z.close()})).catch(G).finally((function(){Z.setSaveButtonText(!1)}))}));Z.setEventListeners();var tt=function(t){var e=document.querySelectorAll(t.formSelector),n={};return e.forEach((function(e){var r=new D(t,e);n[e.getAttribute("name")]=r,r.enableValidation(t)})),n}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"});N.addEventListener("click",(function(){tt.itemAdd.resetErrors(),X.open()})),V.addEventListener("click",(function(){W.setInputValues($.getUserInfo()),tt.editProfile.resetErrors(),W.open()})),H.addEventListener("click",(function(){tt.avatarEdit.resetErrors(),Z.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LHNCQzZLVixTQUFINkMsR0FBaUIsSUFBWDFILEVBQUkwSCxFQUFKMUgsS0FDMUIwTSxFQUFnQmYsbUJBQWtCLEdBQ2xDekIsRUFDR3lDLFdBQVczTSxHQUNYNkcsTUFBSyxTQUFDN0csR0FDTHNLLEVBQVNXLFVBQVVqTCxFQUFLdUgsUUFDeEJtRixFQUFnQi9JLE9BQ2xCLElBQ0N5SCxNQUFNYixHQUNOc0IsU0FBUSxXQUNQYSxFQUFnQmYsbUJBQWtCLEVBQ3BDLEdBQ0osSUFJQWUsRUFBZ0JyQyxvQkFHaEIsSUFjTXVDLEdBZHVCLFNBQUMvRSxHQUM1QixJQUFNZ0YsRUFBUTlOLFNBQVNtRyxpQkFBaUIyQyxFQUFPaUYsY0FDekNGLEVBQWlCLENBQUMsRUFReEIsT0FOQUMsRUFBTXZKLFNBQVEsU0FBQ3lKLEdBQ2IsSUFBTUMsRUFBWSxJQUFJcEYsRUFBY0MsRUFBUWtGLEdBQzVDSCxFQUFlRyxFQUFLRSxhQUFhLFNBQVdELEVBQzVDQSxFQUFVRSxpQkFBaUJyRixFQUM3QixJQUVPK0UsQ0FDVCxDQUd1Qk8sQ0R0TUQsQ0FDcEJMLGFBQWMsZUFDZDlFLGNBQWUsZ0JBQ2ZFLHFCQUFzQixzQkFDdEJFLG9CQUFxQiw4QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVkseUJDbU1keUIsRUFBYzNILGlCQUFpQixTQS9DUixXQUNyQnNLLEdBQXdCLFFBQUVRLGNBQzFCYixFQUFhaEIsTUFDZixJQTZDQXZCLEVBQWtCMUgsaUJBQWlCLFNBMUVYLFdBQ3RCOEosRUFBYWlCLGVBQWUvQyxFQUFTTSxlQUNyQ2dDLEdBQTRCLFlBQUVRLGNBQzlCaEIsRUFBYWIsTUFDZixJQXVFQXhCLEVBQVl6SCxpQkFBaUIsU0FBUyxXQUNwQ3NLLEdBQTJCLFdBQUVRLGNBQzdCVixFQUFnQm5CLE1BQ2xCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBpbmZvU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fbmFtZVVzZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXRVc2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpbmZvU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhclVzZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfTtcblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZVVzZXIudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50XG4gICAgfTtcbiAgfTtcblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lVXNlci50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXRVc2VyLnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH07XG5cbiAgc2V0QXZhdGFyKHVybCkge1xuICAgIHRoaXMuX2F2YXRhclVzZXIuc3JjID0gdXJsO1xuICB9XG5cblxuICBzZXRVc2VySWQoX2lkKSB7XG4gICAgdGhpcy5fdXNlcklkID0gX2lkXG4gIH1cblxuICBnZXRVc2VySWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJZDtcbiAgfVxufTtcblxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgdXNlcklkLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZVRyYXNoQ2xpY2ssIGhhbmRsZUxpa2VDbGljayB9LCB0ZW1wbGF0ZVNlbGVjdG9yKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEubGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gICAgdGhpcy5fbGlrZUNvdW50ZXIgPSBkYXRhLmxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX190aXRsZScpO1xuICAgIHRoaXMuX2VsZW1lbnRQaG90byA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19waG90bycpO1xuICAgIHRoaXMuX2VsZW1lbnRMaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19saWtlLWNvdW50ZXInKTtcbiAgICB0aGlzLl9lbGVtZW50VHJhc2ggPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fdHJhc2gnKTtcbiAgICB0aGlzLl9lbGVtZW50TGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19saWtlJyk7XG5cbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19faXRlbScpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9O1xuXG4gIF9oYXNIaWRkZW5UcmFzaEJ0bigpIHtcbiAgICBpZiAodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XG4gICAgICB0aGlzLl9lbGVtZW50VHJhc2gucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgX2FkZExpa2UgPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudExpa2UuY2xhc3NMaXN0LmFkZCgnZWxlbWVudHNfX2xpa2VfYWN0aXZlJyk7XG4gICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XG4gICAgdGhpcy5fZWxlbWVudExpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZUNvdW50ZXI7XG4gIH1cblxuICBfcmVtb3ZlTGlrZSA9ICgpID0+IHtcbiAgICB0aGlzLl9lbGVtZW50TGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdlbGVtZW50c19fbGlrZV9hY3RpdmUnKTtcbiAgICB0aGlzLl9pc0xpa2VkID0gZmFsc2U7XG4gICAgdGhpcy5fZWxlbWVudExpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZUNvdW50ZXI7XG4gIH1cblxuICBfc2V0TGlrZXNDb3VudGVyID0gKGRhdGEpID0+IHtcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICB9XG5cbiAgX3JlbW92ZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIF9oYW5kbGVDYXJkSW1hZ2VDbGljayA9ICgpID0+IHtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICB9XG5cbiAgX2hhbmRsZVRyYXNoSW1hZ2VDbGljayA9ICgpID0+IHtcbiAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKFxuICAgICAgdGhpcy5fY2FyZElkLFxuICAgICAgdGhpcy5fcmVtb3ZlQ2FyZFxuICAgICAgKTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlSW1hZ2VDbGljayA9ICgpID0+IHtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soXG4gICAgICB0aGlzLl9jYXJkSWQsXG4gICAgICB0aGlzLl9pc0xpa2VkLFxuICAgICAgdGhpcy5fYWRkTGlrZSxcbiAgICAgIHRoaXMuX3JlbW92ZUxpa2UsXG4gICAgICB0aGlzLl9zZXRMaWtlc0NvdW50ZXJcbiAgICApO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnRQaG90by5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUNhcmRJbWFnZUNsaWNrKTtcbiAgICB0aGlzLl9lbGVtZW50VHJhc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVUcmFzaEltYWdlQ2xpY2spO1xuICAgIHRoaXMuX2VsZW1lbnRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlTGlrZUltYWdlQ2xpY2spO1xuXG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50UGhvdG8uYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50UGhvdG8uc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9lbGVtZW50TGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlQ291bnRlcjtcbiAgICB0aGlzLl9oYXNIaWRkZW5UcmFzaEJ0bigpO1xuXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2FkZExpa2UoKTtcbiAgICB9XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IocmVuZGVyZXIsIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfTtcblxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICB9O1xuXG4gIHJlbmRlckl0ZW1zKHJlbmRlckl0ZW1zKSB7XG4gICAgcmVuZGVySXRlbXMucmV2ZXJzZSgpLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuYWRkSXRlbSh0aGlzLl9yZW5kZXJlcihpdGVtKSk7XG4gICAgfSk7XG4gIH07XG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZScpO1xuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xuICB9O1xuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcbiAgfTtcblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfTtcblxuICBfaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGlmIChcbiAgICAgIGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwIHx8XG4gICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9jbG9zZUJ1dHRvblxuICAgICkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH07XG59O1xuXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fcGhvdG8nKTtcbiAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3Bob3RvLWNhcHRpb24nKTtcbiAgfTtcblxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfTtcbn07XG5cbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0Rm9ybUNhbGxiYWNrKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc3VibWl0Rm9ybUNhbGxiYWNrID0gc3VibWl0Rm9ybUNhbGxiYWNrO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB0aGlzLl9idXR0b25Gb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24tc2F2ZScpO1xuICAgIHRoaXMuX2J1dHRvbkZvcm1UZXh0ID0gdGhpcy5fYnV0dG9uRm9ybS50ZXh0Q29udGVudDtcbiAgfTtcblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfTtcblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fc3VibWl0Rm9ybUNhbGxiYWNrKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9O1xuXG4gIHNldFNhdmVCdXR0b25UZXh0KGlzU2F2aW5nKSB7XG4gICAgaWYgKGlzU2F2aW5nKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbkZvcm0udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRm9ybS50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvbkZvcm1UZXh0O1xuICAgICAgfVxuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfTtcbn07XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0Rm9ybUNhbGxiYWNrKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc3VibWl0Rm9ybUNhbGxiYWNrID0gc3VibWl0Rm9ybUNhbGxiYWNrO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX2J1dHRvbkZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbi1zYXZlJyk7XG4gICAgdGhpcy5fYnV0dG9uRm9ybVRleHQgPSB0aGlzLl9idXR0b25Gb3JtLnRleHRDb250ZW50O1xuICB9O1xuXG4gIHN1Ym1pdENhbGxiYWNrKHJlbW92aW5nKSB7XG4gICAgdGhpcy5fc3VibWl0Rm9ybUNhbGxiYWNrID0gcmVtb3Zpbmc7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEZvcm1DYWxsYmFjaygpO1xuICAgIH0pO1xuICB9O1xuXG4gIHNldFNhdmVCdXR0b25UZXh0KGlzU2F2aW5nKSB7XG4gICAgaWYgKGlzU2F2aW5nKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbkZvcm0udGV4dENvbnRlbnQgPSAn0KPQtNCw0LvQtdC90LjQtS4uLic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9idXR0b25Gb3JtLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uRm9ybVRleHQ7XG4gICAgICB9O1xuICB9O1xuXG4gIG9wZW4oY2FyZElkLCBjYXJkKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmRJZDtcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcbiAgfVxuXG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfTtcblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH1cbiAgfTtcblxuICBnZXRJdGVtcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gIH07XG5cbiAgc2V0SXRlbSh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfTtcblxuICBkZWxldGVJdGVtKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfTtcblxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfTtcblxuICBkZWxldGVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfTtcblxuICBlZGl0QXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7YXZhdGFyfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xuICB9O1xuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHsgaGVhZGVyczogdGhpcy5faGVhZGVycyB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfTtcblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IG5hbWUsIGFib3V0OiBhYm91dCB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gIH07XG5cbn07XG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHNIYW5kbGVyID0gdGhpcy5fZm9ybUlucHV0c0hhbmRsZXIuYmluZCh0aGlzKTtcbiAgfTtcblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCA/IHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkgOiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICB9O1xuXG4gIF9mb3JtSW5wdXRzSGFuZGxlcihldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcyh0aGlzLl9pbnB1dFNlbGVjdG9yKSkge1xuICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGV2ZW50LnRhcmdldCk7XG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIH07XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBoYXNJbnZhbGlkSW5wdXQ7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MsIGhhc0ludmFsaWRJbnB1dCk7XG4gIH07XG5cbiAgX3Jlc2V0Rm9ybUhhbmRsZXIoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5fZm9ybUlucHV0c0hhbmRsZXIpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgdGhpcy5fcmVzZXRGb3JtSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9O1xuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfTtcblxuICByZXNldEVycm9ycygpIHtcbiAgICB0aGlzLl9yZXNldEZvcm1IYW5kbGVyKCk7XG4gIH07XG59O1xuIiwiZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lU2VsZWN0b3IgPSAnLnByb2ZpbGVfX25hbWUnO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBYm91dFNlbGVjdG9yID0gJy5wcm9maWxlX19hYm91dCc7XG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhclNlbGVjdG9yID0gJy5wcm9maWxlX19hdmF0YXInO1xuZXhwb3J0IGNvbnN0IGNvbnRhaW5lclNlbGVjdG9yID0gJy5lbGVtZW50c19fY2FyZHMnO1xuZXhwb3J0IGNvbnN0IHRlbXBsYXRlU2VsZWN0b3IgPSAnI2NhcmQtdGVtcGxhdGUnO1xuZXhwb3J0IGNvbnN0IHBvcHVwUHJvZmlsZVNlbGVjdG9yID0gJy5wb3B1cF9lZGl0J1xuZXhwb3J0IGNvbnN0IHBvcHVwQXZhdGFyU2VsZWN0b3IgPSAnLnBvcHVwX2VkaXQtYXZhdGFyJztcbmV4cG9ydCBjb25zdCBwb3B1cEl0ZW1TZWxlY3RvciA9ICcucG9wdXBfaXRlbSc7XG5leHBvcnQgY29uc3QgcG9wdXBWaWV3U2VsZWN0b3IgPSAnLnBvcHVwX2l0ZW1fcGhvdG8tdmlldyc7XG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGVTZWxlY3RvciA9ICcucG9wdXBfaXRlbV9kZWxldGUtY2FyZCc7XG5leHBvcnQgY29uc3QgYXZhdGFyQmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyLWJsb2NrJyk7XG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvblByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYnV0dG9uLWVkaXQnKTtcbmV4cG9ydCBjb25zdCBhZGRCdXR0b25DYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2J1dHRvbi1hZGQtaXRlbScpO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24tc2F2ZScsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uLXNhdmVfZGlzYWJsZWQnLFxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcbn07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHtcbiAgY29uZmlnLFxuICBjb250YWluZXJTZWxlY3RvcixcbiAgdGVtcGxhdGVTZWxlY3RvcixcbiAgcG9wdXBWaWV3U2VsZWN0b3IsXG4gIHBvcHVwUHJvZmlsZVNlbGVjdG9yLFxuICBwb3B1cEl0ZW1TZWxlY3RvcixcbiAgcG9wdXBBdmF0YXJTZWxlY3RvcixcbiAgcG9wdXBEZWxldGVTZWxlY3RvcixcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcixcbiAgcHJvZmlsZUFib3V0U2VsZWN0b3IsXG4gIHByb2ZpbGVBdmF0YXJTZWxlY3RvcixcbiAgZWRpdEJ1dHRvblByb2ZpbGUsXG4gIGF2YXRhckJsb2NrLFxuICBhZGRCdXR0b25DYXJkLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjMvXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjUzMjI1YTc5LTgwOGMtNDUwMi1hZjk4LTc2MDg5ZGRhMzI2Y1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vINCh0L7Qt9C00LDRkdC8INGN0LrQt9C10LzQv9C70Y/RgCDQutC70LDRgdGB0LAg0LTQu9GPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0YPQstC10LvQuNGH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuFxuY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cFZpZXdTZWxlY3Rvcik7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuXG4vLyDQmNC90YTQvtGA0LzQsNGG0LjRjyDQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70LVcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBwcm9maWxlTmFtZVNlbGVjdG9yLFxuICBwcm9maWxlQWJvdXRTZWxlY3RvcixcbiAgcHJvZmlsZUF2YXRhclNlbGVjdG9yXG4pO1xuLy8g0JjQvdGE0L7RgNC80LDRhtC40Y8g0L7QsSDQvtGI0LjQsdC60LDRhSDRgSDRgdC10YDQstC10YDQsFxuY29uc3QgaGFuZGxlRXJyb3IgPSAoZXJyKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKTtcblxuLy8g0JLRi9C/0L7Qu9C90Y/QtdC8INC30LDQv9GA0L7RgdGLINC6INGB0LXRgNCy0LXRgNGDXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJdGVtcygpXSlcbiAgLnRoZW4oKFt1c2VySW5mb0RhdGEsIGl0ZW1zRGF0YV0pID0+IHtcbiAgICBjb25zdCB7IG5hbWUsIGFib3V0LCBhdmF0YXIsIF9pZCB9ID0gdXNlckluZm9EYXRhO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSk7XG4gICAgdXNlckluZm8uc2V0QXZhdGFyKGF2YXRhcik7XG4gICAgdXNlckluZm8uc2V0VXNlcklkKF9pZCk7XG5cbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhpdGVtc0RhdGEpO1xuICB9KVxuICAuY2F0Y2goaGFuZGxlRXJyb3IpO1xuXG5cbi8v0KHQvtC30LTQsNC90LjQtSDQutCw0YDRgtC+0YfQutC4XG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcbiAgY29uc3QgdXNlcklkID0gdXNlckluZm8uZ2V0VXNlcklkKCk7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhOiBkYXRhLFxuICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6IChuYW1lLCBsaW5rKSA9PiB7XG4gICAgICAgIHBvcHVwSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVUcmFzaENsaWNrOiAoY2FyZElkLCByZW1vdmVDYXJkKSA9PiB7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5vcGVuKCk7XG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5zdWJtaXRDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgcG9wdXBEZWxldGVDYXJkLnNldFNhdmVCdXR0b25UZXh0KHRydWUpO1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRlbGV0ZUl0ZW0oY2FyZElkKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICByZW1vdmVDYXJkKCk7XG4gICAgICAgICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5jbG9zZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcilcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgcG9wdXBEZWxldGVDYXJkLnNldFNhdmVCdXR0b25UZXh0KGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2xpY2s6IChcbiAgICAgICAgY2FyZElkLFxuICAgICAgICBpc0xpa2VkLFxuICAgICAgICBhZGRMaWtlLFxuICAgICAgICByZW1vdmVMaWtlLFxuICAgICAgICBzZXRMaWtlc0NvdW50ZXJcbiAgICAgICkgPT4ge1xuICAgICAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRlbGV0ZUxpa2UoY2FyZElkKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgc2V0TGlrZXNDb3VudGVyKGRhdGEpO1xuICAgICAgICAgICAgICByZW1vdmVMaWtlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5hZGRMaWtlKGNhcmRJZClcbiAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgIHNldExpa2VzQ291bnRlcihkYXRhKTtcbiAgICAgICAgICAgICAgYWRkTGlrZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVNlbGVjdG9yXG4gICkuZ2VuZXJhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkO1xufTtcblxuLy8g0KHQvtC30LTQsNGR0Lwg0Y3QutC30LXQvNC/0LvRj9GAINC60LvQsNGB0YHQsCDQtNC70Y8g0YHQv9C40YHQutCwINC60LDRgNGC0L7Rh9C10LpcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oY3JlYXRlQ2FyZCwgY29udGFpbmVyU2VsZWN0b3IpO1xuXG4vLyDQpNGD0L3QutGG0LjRjy3QvtCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0YXRgNCw0L3QtdC90LjRjyDQuNC30LzQtdC90LXQvdC40Lkg0L/RgNC+0YTQuNC70Y9cbmNvbnN0IHByb2ZpbGVGb3JtU3VibWl0ID0gKGluZm9EYXRhKSA9PiB7XG4gIHBvcHVwUHJvZmlsZS5zZXRTYXZlQnV0dG9uVGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLnNldFVzZXJJbmZvKGluZm9EYXRhKVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IHVzZXIubmFtZSwgYWJvdXQ6IHVzZXIuYWJvdXQgfSk7XG4gICAgICBwb3B1cFByb2ZpbGUuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaChoYW5kbGVFcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cFByb2ZpbGUuc2V0U2F2ZUJ1dHRvblRleHQoZmFsc2UpO1xuICAgIH0pO1xufTtcblxuLy8g0JLRgdC/0LvRi9Cy0LDRjtGJ0LXQtSDQvtC60L3QviDRgSDRhNC+0YDQvNC+0Lkg0LTQu9GPINC/0YDQvtGE0LjQu9GPXG5jb25zdCBwb3B1cFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cFByb2ZpbGVTZWxlY3RvciwgcHJvZmlsZUZvcm1TdWJtaXQpO1xucG9wdXBQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vINCk0YPQvdC60YbQuNGPLdC+0LHRgNCw0LHQvtGC0YfQuNC6INC90LDQttCw0YLQuNGPINC90LAg0LrQvdC+0L/QutGDINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0L/RgNC+0YTQuNC70Y9cbmNvbnN0IGVkaXRCdXR0b25DbGljayA9ICgpID0+IHtcbiAgcG9wdXBQcm9maWxlLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xuICBmb3JtVmFsaWRhdG9yc1tcImVkaXRQcm9maWxlXCJdLnJlc2V0RXJyb3JzKCk7XG4gIHBvcHVwUHJvZmlsZS5vcGVuKCk7XG59O1xuXG4vLyDQpNGD0L3QutGG0LjRjy3QvtCx0YDQsNCx0L7RgtGH0LjQuiDQtNC+0LHQsNCy0LvQtdC90LjRjyDQvdC+0LLQvtC5INC60LDRgNGC0L7Rh9C60LhcbmNvbnN0IGFkZENhcmRGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgcG9wdXBBZGRDYXJkLnNldFNhdmVCdXR0b25UZXh0KHRydWUpO1xuICBhcGlcbiAgICAuc2V0SXRlbSh7IG5hbWU6IGRhdGEudGl0bGUsIGxpbms6IGRhdGEudXJsIH0pXG4gICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkKSk7XG4gICAgICBwb3B1cEFkZENhcmQuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaChoYW5kbGVFcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cEFkZENhcmQuc2V0U2F2ZUJ1dHRvblRleHQoZmFsc2UpO1xuICAgIH0pO1xufTtcblxuLy8g0JLRgdC/0LvRi9Cy0LDRjtGJ0LXQtSDQvtC60L3QviDRgSDRhNC+0YDQvNC+0Lkg0LTQu9GPINC00L7QsdCw0LLQu9C10L3QuNGPINC60LDRgNGC0L7Rh9C60LhcbmNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwSXRlbVNlbGVjdG9yLCBhZGRDYXJkRm9ybVN1Ym1pdCk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8g0KTRg9C90LrRhtC40Y8t0L7QsdGA0LDQsdC+0YLRh9C40Log0L3QsNC20LDRgtC40Y8g0L3QsCDQutC90L7Qv9C60YMg0LTQvtCx0LDQstC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxuY29uc3QgYWRkQnV0dG9uQ2xpY2sgPSAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW1wiaXRlbUFkZFwiXS5yZXNldEVycm9ycygpO1xuICBwb3B1cEFkZENhcmQub3BlbigpO1xufTtcblxuLy8g0JLRgdC/0LvRi9Cy0LDRjtGJ0LXQtSDQvtC60L3QviDRgSDRhNC+0YDQvNC+0Lkg0LTQu9GPINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxuY29uc3QgcG9wdXBEZWxldGVDYXJkID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihwb3B1cERlbGV0ZVNlbGVjdG9yKTtcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cbi8vINCk0YPQvdC60YbQuNGPLdC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YLQv9GA0LDQstC60Lgg0YTQvtGA0LzRiyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINCw0LLQsNGC0LDRgNCwXG5jb25zdCBhdmF0YXJGb3JtU3VibWl0ID0gKHsgZGF0YSB9KSA9PiB7XG4gIHBvcHVwQXZhdGFyRWRpdC5zZXRTYXZlQnV0dG9uVGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRBdmF0YXIoZGF0YSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGRhdGEuYXZhdGFyKTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGhhbmRsZUVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdC5zZXRTYXZlQnV0dG9uVGV4dChmYWxzZSk7XG4gICAgfSk7XG59O1xuXG4vLyDQktGB0L/Qu9GL0LLQsNGO0YnQtdC1INC+0LrQvdC+INGBINGE0L7RgNC80L7QuSDQtNC70Y8g0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyDQsNCy0LDRgtCw0YDQsFxuY29uc3QgcG9wdXBBdmF0YXJFZGl0ID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBdmF0YXJTZWxlY3RvciwgYXZhdGFyRm9ybVN1Ym1pdCk7XG5wb3B1cEF2YXRhckVkaXQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8g0KTRg9C90LrRhtC40Y8g0LjQvdC40YbQuNCw0LvQuNC30LDRhtC40Lgg0LLQsNC70LjQtNCw0YbQuNC4INGE0L7RgNC8XG5jb25zdCBpbml0aWFsaXplVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBjb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG4gIGZvcm1zLmZvckVhY2goKGZvcm0pID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm0pO1xuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGZvcm1WYWxpZGF0b3JzO1xufTtcblxuLy8g0JjQvdC40YbQuNCw0LvQuNC30LjRgNGD0LXQvCDQstCw0LvQuNC00LDRhtC40Y4g0YTQvtGA0LxcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0gaW5pdGlhbGl6ZVZhbGlkYXRpb24oY29uZmlnKTtcblxuLy8g0JTQvtCx0LDQstC70Y/QtdC8INGB0LvRg9GI0LDRgtC10LvQuCDQvdCwINC60L3QvtC/0LrQuFxuYWRkQnV0dG9uQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYWRkQnV0dG9uQ2xpY2spO1xuZWRpdEJ1dHRvblByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGVkaXRCdXR0b25DbGljayk7XG5hdmF0YXJCbG9jay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhckVkaXRcIl0ucmVzZXRFcnJvcnMoKTtcbiAgcG9wdXBBdmF0YXJFZGl0Lm9wZW4oKTtcbn0pO1xuIl0sIm5hbWVzIjpbIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiaW5mb1NlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX25hbWVVc2VyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2Fib3V0VXNlciIsIl9hdmF0YXJVc2VyIiwia2V5IiwidmFsdWUiLCJuYW1lIiwidGV4dENvbnRlbnQiLCJhYm91dCIsIl9yZWYiLCJ1cmwiLCJzcmMiLCJfaWQiLCJfdXNlcklkIiwiQ2FyZCIsInRlbXBsYXRlU2VsZWN0b3IiLCJfdGhpcyIsImRhdGEiLCJ1c2VySWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVUcmFzaENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiX2RlZmluZVByb3BlcnR5IiwiX2VsZW1lbnRMaWtlIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2lzTGlrZWQiLCJfZWxlbWVudExpa2VDb3VudGVyIiwiX2xpa2VDb3VudGVyIiwicmVtb3ZlIiwibGlrZXMiLCJsZW5ndGgiLCJfZWxlbWVudCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfbmFtZSIsImxpbmsiLCJfbGluayIsIl9oYW5kbGVUcmFzaENsaWNrIiwiX2NhcmRJZCIsIl9yZW1vdmVDYXJkIiwiX2hhbmRsZUxpa2VDbGljayIsIl9hZGRMaWtlIiwiX3JlbW92ZUxpa2UiLCJfc2V0TGlrZXNDb3VudGVyIiwiX293bmVySWQiLCJvd25lciIsInNvbWUiLCJsaWtlIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJfZWxlbWVudFRpdGxlIiwiX2VsZW1lbnRQaG90byIsIl9lbGVtZW50VHJhc2giLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDYXJkSW1hZ2VDbGljayIsIl9oYW5kbGVUcmFzaEltYWdlQ2xpY2siLCJfaGFuZGxlTGlrZUltYWdlQ2xpY2siLCJhbHQiLCJfaGFzSGlkZGVuVHJhc2hCdG4iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJTZWN0aW9uIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwicmV2ZXJzZSIsImZvckVhY2giLCJhZGRJdGVtIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiZXZ0IiwiY2xvc2UiLCJ0YXJnZXQiLCJfcG9wdXAiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsaWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl90aGlzMiIsIlBvcHVwV2l0aEltYWdlIiwiX1BvcHVwIiwiX2luaGVyaXRzIiwiX3N1cGVyIiwiY2FsbCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsIl9nZXQiLCJfZ2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0Rm9ybUNhbGxiYWNrIiwiX3N1Ym1pdEZvcm1DYWxsYmFjayIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25Gb3JtIiwiX2J1dHRvbkZvcm1UZXh0IiwiZm9ybVZhbHVlcyIsImlucHV0IiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpc1NhdmluZyIsInJlc2V0IiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwicmVtb3ZpbmciLCJjYXJkSWQiLCJjYXJkIiwiX2NhcmQiLCJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY29uY2F0Iiwic3RhdHVzIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrUmVzcG9uc2UiLCJfcmVmMiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiX3RoaXMzIiwiX3RoaXM0IiwiX3RoaXM1IiwiYXZhdGFyIiwiX3RoaXM2IiwiX3RoaXM3IiwiX3JlZjMiLCJfdGhpczgiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJfYnV0dG9uRWxlbWVudCIsIl9mb3JtSW5wdXRzSGFuZGxlciIsImJpbmQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImV2ZW50IiwibWF0Y2hlcyIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsInRvZ2dsZSIsIl9yZXNldEZvcm1IYW5kbGVyIiwiYXZhdGFyQmxvY2siLCJlZGl0QnV0dG9uUHJvZmlsZSIsImFkZEJ1dHRvbkNhcmQiLCJhcGkiLCJhdXRob3JpemF0aW9uIiwicG9wdXBJbWFnZSIsInNldEV2ZW50TGlzdGVuZXJzIiwidXNlckluZm8iLCJoYW5kbGVFcnJvciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEl0ZW1zIiwidXNlckluZm9EYXRhIiwiaXRlbXNEYXRhIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJzZXRVc2VySWQiLCJjYXJkTGlzdCIsImNhdGNoIiwiY3JlYXRlQ2FyZCIsImdldFVzZXJJZCIsIm9wZW4iLCJyZW1vdmVDYXJkIiwicG9wdXBEZWxldGVDYXJkIiwic3VibWl0Q2FsbGJhY2siLCJzZXRTYXZlQnV0dG9uVGV4dCIsImRlbGV0ZUl0ZW0iLCJmaW5hbGx5IiwiaXNMaWtlZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwic2V0TGlrZXNDb3VudGVyIiwiZGVsZXRlTGlrZSIsImdlbmVyYXRlQ2FyZCIsInBvcHVwUHJvZmlsZSIsImluZm9EYXRhIiwidXNlciIsInBvcHVwQWRkQ2FyZCIsInNldEl0ZW0iLCJ0aXRsZSIsInBvcHVwQXZhdGFyRWRpdCIsImVkaXRBdmF0YXIiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1zIiwiZm9ybVNlbGVjdG9yIiwiZm9ybSIsInZhbGlkYXRvciIsImdldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJpbml0aWFsaXplVmFsaWRhdGlvbiIsInJlc2V0RXJyb3JzIiwic2V0SW5wdXRWYWx1ZXMiXSwic291cmNlUm9vdCI6IiJ9